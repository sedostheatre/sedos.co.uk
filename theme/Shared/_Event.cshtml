@model IDocument

@{
    Layout = "_Page";
}

<div class="row">
    <div class="col-md-8 pt-3">
        @RenderBody()
    </div>
    <div class="col-md-4 events-column pt-3">
        <h3>Essential info</h3>
        @{
            if(Model.ContainsKey("venue"))
            {
                var venues = Documents["Venues"].Single().Get<IEnumerable<IDocument>>("venues");
                var venue = venues.FirstOrDefault(x => x["key"].ToString().Equals(Model["venue"].ToString()));
                if(venue != null)
                {
                    <h4><a href="@venue["url"]">@venue["name"]</a></h4>
                }
                else
                {
                    <h4>@Model["venue"]</h4>
                }
            }
        }
        @{
            if(Model.ContainsKey("recurrence"))
            {
                <h5>@Model.Get("recurrence")</h5>
            }
            var times = Model.Get("times", Enumerable.Empty<IDocument>())
                             .Select(time => time.Get<DateTime>("time"));
            if(times.Any())
            {
                <ul>
                    @foreach(var time in times
                            .Select(t => t.ToString("dddd dd MMMM yyyy h.mm") + t.ToString("tt").ToLower())
                    )
                    {
                        <li>@time</li>
                    }
                </ul>
            }

            if(Model.Get("ticket-prices", null) != null)
            {
                <h5>@Model.Get("ticket-prices", null)</h5>
            }
        }
    </div>
</div>
